<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-4xl">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h1 class="text-2xl font-bold text-gray-800 mb-2">Personal Finance Tracker</h1>
            <p class="text-gray-600">Take control of your finances with smart tracking</p>
            <div class="mt-2 p-3 bg-blue-50 border border-blue-200 rounded">
                <p class="text-sm text-blue-700">üí° <strong>Note:</strong> Data is stored in memory only. Use Export to save your data, and Import to restore it.</p>
            </div>
        </div>

        <!-- Budget Overview -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-2">Monthly Budget</h3>
                <div class="text-2xl font-bold text-blue-600" id="budgetAmount">¬£3000</div>
                <button onclick="editBudget()" class="text-sm text-blue-500 hover:underline">Edit Budget</button>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-2">Total Spent</h3>
                <div class="text-2xl font-bold text-green-600" id="totalSpent">¬£0</div>
            </div>
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold mb-2">Remaining</h3>
                <div class="text-2xl font-bold text-purple-600" id="remaining">¬£3000</div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h3 class="text-lg font-semibold mb-2">Budget Progress</h3>
            <div class="w-full bg-gray-200 rounded-full h-4">
                <div id="progressBar" class="bg-blue-600 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
            <p class="text-sm text-gray-600 mt-2" id="progressText">0% of budget used</p>
        </div>

        <!-- Add Expense Form -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">Add New Expense</h3>
            <form id="expenseForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <input type="text" id="expenseName" placeholder="Expense name" class="border rounded p-2" required>
                <input type="number" id="expenseCost" placeholder="Cost" step="0.01" class="border rounded p-2" required>
                <select id="expenseType" class="border rounded p-2">
                    <option value="essential">Essential</option>
                    <option value="non-essential">Non-Essential</option>
                </select>
                <select id="expenseCategory" class="border rounded p-2">
                    <option value="housing">Housing</option>
                    <option value="food">Food</option>
                    <option value="transport">Transport</option>
                    <option value="entertainment">Entertainment</option>
                    <option value="utilities">Utilities</option>
                    <option value="shopping">Shopping</option>
                    <option value="health">Health</option>
                    <option value="other">Other</option>
                </select>
                <button type="submit" class="bg-blue-600 text-white rounded p-2 hover:bg-blue-700">Add Expense</button>
            </form>
        </div>

        <!-- Category Summary -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">Spending by Category</h3>
            <div id="categoryBreakdown" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <p class="text-gray-500 col-span-full text-center py-4">Add expenses to see category breakdown</p>
            </div>
        </div>

        <!-- Expenses List -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h3 class="text-lg font-semibold mb-4">Your Expenses</h3>
            <div id="expensesList" class="space-y-2">
                <p class="text-gray-500 text-center py-8">No expenses yet. Add your first expense above!</p>
            </div>
        </div>

        <!-- Export/Import -->
        <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-semibold mb-4">Data Management</h3>
            <div class="flex flex-wrap gap-4">
                <button onclick="exportData()" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
                    üì• Export Data
                </button>
                <button onclick="document.getElementById('importFile').click()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                    üì§ Import Data
                </button>
                <button onclick="clearAllData()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
                    üóëÔ∏è Clear All
                </button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
            </div>
            <p class="text-sm text-gray-600 mt-2">Remember to export your data regularly to avoid losing it!</p>
        </div>
    </div>

    <script>
        // In-memory storage only (no localStorage)
        let expenses = [];
        let monthlyBudget = 3000;

        function updateDisplay() {
            const totalSpent = expenses.reduce((sum, expense) => sum + expense.cost, 0);
            const remaining = monthlyBudget - totalSpent;
            const percentUsed = monthlyBudget > 0 ? (totalSpent / monthlyBudget) * 100 : 0;

            document.getElementById('budgetAmount').textContent = `¬£${monthlyBudget.toFixed(2)}`;
            document.getElementById('totalSpent').textContent = `¬£${totalSpent.toFixed(2)}`;
            document.getElementById('remaining').textContent = `¬£${remaining.toFixed(2)}`;
            document.getElementById('progressBar').style.width = `${Math.min(percentUsed, 100)}%`;
            document.getElementById('progressText').textContent = `${percentUsed.toFixed(1)}% of budget used`;

            // Change progress bar color based on usage
            const progressBar = document.getElementById('progressBar');
            if (percentUsed > 90) {
                progressBar.className = 'bg-red-600 h-4 rounded-full transition-all duration-300';
            } else if (percentUsed > 75) {
                progressBar.className = 'bg-yellow-600 h-4 rounded-full transition-all duration-300';
            } else {
                progressBar.className = 'bg-blue-600 h-4 rounded-full transition-all duration-300';
            }

            renderExpenses();
            renderCategoryBreakdown();
        }

        function renderExpenses() {
            const container = document.getElementById('expensesList');
            
            if (expenses.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-8">No expenses yet. Add your first expense above!</p>';
                return;
            }

            container.innerHTML = expenses.map((expense, index) => `
                <div class="flex justify-between items-center p-4 bg-gray-50 rounded border hover:bg-gray-100 transition-colors">
                    <div class="flex-1">
                        <div class="flex items-center gap-3">
                            <span class="font-medium">${expense.name}</span>
                            <span class="text-sm px-2 py-1 rounded ${expense.type === 'essential' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}">
                                ${expense.type}
                            </span>
                            <span class="text-sm px-2 py-1 rounded bg-gray-200 text-gray-700 capitalize">
                                ${expense.category}
                            </span>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <span class="font-semibold text-lg">¬£${expense.cost.toFixed(2)}</span>
                        <button onclick="deleteExpense(${index})" class="text-red-600 hover:text-red-800 hover:bg-red-50 px-2 py-1 rounded">
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderCategoryBreakdown() {
            const container = document.getElementById('categoryBreakdown');
            
            if (expenses.length === 0) {
                container.innerHTML = '<p class="text-gray-500 col-span-full text-center py-4">Add expenses to see category breakdown</p>';
                return;
            }

            // Calculate category totals
            const categoryTotals = expenses.reduce((acc, expense) => {
                acc[expense.category] = (acc[expense.category] || 0) + expense.cost;
                return acc;
            }, {});

            const totalSpent = expenses.reduce((sum, expense) => sum + expense.cost, 0);

            container.innerHTML = Object.entries(categoryTotals)
                .sort(([,a], [,b]) => b - a)
                .map(([category, amount]) => {
                    const percentage = totalSpent > 0 ? (amount / totalSpent) * 100 : 0;
                    return `
                        <div class="p-3 bg-gray-50 rounded border">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-medium capitalize">${category}</span>
                                <span class="font-semibold">¬£${amount.toFixed(2)}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-600 h-2 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                            <p class="text-xs text-gray-600 mt-1">${percentage.toFixed(1)}% of total</p>
                        </div>
                    `;
                }).join('');
        }

        function addExpense(expense) {
            expenses.push(expense);
            updateDisplay();
        }

        function deleteExpense(index) {
            if (confirm('Delete this expense?')) {
                expenses.splice(index, 1);
                updateDisplay();
            }
        }

        function editBudget() {
            const newBudget = prompt('Enter your monthly budget:', monthlyBudget);
            if (newBudget && !isNaN(newBudget) && newBudget > 0) {
                monthlyBudget = parseFloat(newBudget);
                updateDisplay();
            }
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear all data? This cannot be undone!')) {
                expenses = [];
                monthlyBudget = 3000;
                updateDisplay();
            }
        }

        function exportData() {
            const data = { 
                expenses, 
                monthlyBudget, 
                exportDate: new Date().toISOString(),
                totalExpenses: expenses.length,
                totalSpent: expenses.reduce((sum, expense) => sum + expense.cost, 0)
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `expense-tracker-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            alert('Data exported successfully!');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.expenses && Array.isArray(data.expenses)) {
                        if (confirm('This will replace all current data. Are you sure?')) {
                            expenses = data.expenses;
                            if (data.monthlyBudget) monthlyBudget = data.monthlyBudget;
                            updateDisplay();
                            alert(`Data imported successfully! Loaded ${expenses.length} expenses.`);
                        }
                    } else {
                        alert('Invalid file format. Please select a valid expense tracker export file.');
                    }
                } catch (error) {
                    alert('Error reading file: ' + error.message);
                }
                event.target.value = '';
            };
            reader.readAsText(file);
        }

        // Form handler
        document.getElementById('expenseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const expense = {
                name: document.getElementById('expenseName').value,
                cost: parseFloat(document.getElementById('expenseCost').value),
                type: document.getElementById('expenseType').value,
                category: document.getElementById('expenseCategory').value,
                date: new Date().toISOString().split('T')[0]
            };
            addExpense(expense);
            this.reset();
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateDisplay();
            
            // Initialize Lucide icons if available
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>
</body>
</html>
